datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Category {
  id            String        @id @default(uuid())
  stableId      String?       @unique
  nameAr        String
  nameEn        String
  subCategories SubCategory[]
  products      Product[]     @relation("ProductCategories") // many-to-many
}

model SubCategory {
  id         String    @id @default(uuid())
  stableId   String?   @unique
  nameAr     String
  nameEn     String
  categoryId String
  category   Category  @relation(fields: [categoryId], references: [id])
  products   Product[] @relation("ProductSubCategories")
}

model Product {
  id            String          @id @default(uuid())
  stableId      String         @unique
  titleAr       String
  titleEn       String
  descriptionAr String?
  descriptionEn String?
  oldPrice      Float           @default(0)
  price         Float
  imageUrl      String
  modelNumber   String?
  compositionAr String?
  compositionEn String?
  inspirationEn String?
  inspirationAr String?
  size          String?         // Ø§Ù„Ø­Ø¬Ù… (100ml, 200ml ...)
  gender        String?         // Male | Female | Unisex
  warrantyAr    String?
  warrantyEn    String?
  categories    Category[]      @relation("ProductCategories")
  subCategories SubCategory[]   @relation("ProductSubCategories")
  stock         Int             @default(0)
  createdAt     DateTime        @default(now())
  orderProducts OrderProduct[]
  media         ProductMedia[]  @relation("ProductMedia")
}

model ProductMedia {
  id        String     @id @default(cuid())
  url       String
  type      MediaType
  language  Language   // ðŸ‘ˆ Ø¹Ø±Ø¨ÙŠ / Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ
  product   Product    @relation("ProductMedia", fields: [productId], references: [id])
  productId String
}

enum Language {
  AR
  EN
  BOTH
}

enum MediaType {
  IMAGE
}

model User {
  id        String   @id @default(uuid())
  clerkId   String   @unique
  email     String?
  firstName String?
  lastName  String?
  imageUrl  String?
  orders    Order[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Order {
  id        String         @id @default(uuid())
  userId    String
  products  OrderProduct[]
  createdAt DateTime       @default(now())
  user      User           @relation(fields: [userId], references: [id])

  @@index([userId])
}

model OrderProduct {
  id        String  @id @default(uuid())
  orderId   String
  productId String
  quantity  Int     @default(1)  // Ø§Ù„ÙƒÙ…ÙŠØ©
  order     Order   @relation(fields: [orderId], references: [id])
  product   Product @relation(fields: [productId], references: [id])

  @@unique([orderId, productId])
}
